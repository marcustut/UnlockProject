{% extends "home/base.html" %}

{% block title %}Mission{% endblock %}

{% block content %}
<div class="container">
  {% load static %}
  <div class="jumbotron active-mission mb-5">
    {% if mission.id == 2 and messages|length == 0 %}
    <div id="yt-player" class="embed-responsive embed-responsive-16by9">
      <div class="embed-responsive-item">
        <div id="mission2-video"></div>
      </div>
    </div>
    <div class="container">
      <div class="col text-center">
        <button type="button" id="start-button" class="btn btn-secondary mt-5 disabled" onclick="startAudio()">Start</button>
      </div>
    </div>
    {% endif %}
    <div id="main-container" class="container-fluid text-center">
      <div class="container mb-5">
        <div class="row">
          <div class="col text-right">
            <button id="languageSwitcher" class="btn btn-sm btn-secondary" onclick="descChangeLang()">中文</button>
          </div>
        </div>
      </div>
      <h1 id="titleChi" class="display-3" style="font-weight: 700;">{{ mission.mission_title_chi }}</h1>
      <h1 id="titleEng" class="display-3" style="display: none; font-weight: 700;">{{ mission.mission_title_eng }}</h1>
      <h3 id="instructionTitle" class="mt-5"><u><b>指示</b></u></h3>
      <h4 id="missionDescChi" class="text-left mt-5">
        {% autoescape off %}
        {{ mission.mission_description_chi }}
        {% endautoescape %}
      </h4>
      <h4 id="missionDescEng" class="text-left mt-5" style="display: none;">
        {% autoescape off %}
        {{ mission.mission_description_eng }}
        {% endautoescape %}
      </h4>
      {% for message in messages %}
      <br>
      <br>
      <div class="container w-75">
        <div class="alert alert-danger mb-4" role="alert">
          {% autoescape off %}
          {{ message }}
          {% endautoescape %}
        </div>
      </div>
      {% endfor %}
      {% if mission.id == 1 %}
      {{ now }}
      <br>
      <br>
      <div class="container mb-4">
        <button id="SpotIMGButton" class="btn btn-primary btn-sm col-sm-3 mt-2 mb-5" onclick="changeSpotIMG()">
          Vertical ➡️ Horizontal
        </button>
      </div>
      <img id="SpotIMG1" src="{% static 'game/spot/VerticalSpot1.jpg' %}" style="max-width: 100%; height: auto;" alt="">
      <form method="POST" class="mt-5" name="spot-the-difference-form">
        {% csrf_token %}
        <div class="row">
          <div class="col">
            <div class="float-right mr-n2">
              <input class="spot-password-long form-control" type="text" minlength="1" maxlength="1"
                value="{{ SpotAnswers.0 }}" name="box1" tabindex="1" required>
            </div>
          </div>
          <div class="col ml-n3">
            <input class="spot-password-long form-control" type="text" minlength="1" maxlength="1"
              value="{{ SpotAnswers.1 }}" name="box2" tabindex="2" required>
          </div>
        </div>
        <br>
        <br>
        <img id="SpotIMG2" src="{% static 'game/spot/VerticalSpot2.jpg' %}" style="max-width: 100%; height: auto;" class="mt-4" alt="">
        <div class="mt-5">
          <div class="row">
            <div class="col">
              <div class="float-right mr-n2">
                <input class="spot-password-long form-control" type="text" minlength="1" maxlength="1"
                  value="{{ SpotAnswers.2 }}" name="box3" tabindex="3" required>
              </div>
            </div>
            <div class="col ml-n3">
              <input class="spot-password-long form-control" type="text" minlength="1" maxlength="1"
                value="{{ SpotAnswers.3 }}" name="box4" tabindex="4" required>
            </div>
          </div>
        </div>
        <input class="btn btn-primary mt-5 ml-2" type="submit" value="Submit" tabindex="5" />
      </form>
      {% elif mission.id == 2 %}
      <br>
      <audio id="CorruptedAudio" class="mt-5" controls>
        <source id="CorruptedAudioSource" src="{% static 'game/audio/CorruptedAudioChinese.mp3' %}" type="audio/mp3">
      </audio>
      <p id="CorruptedAudioTitle">Chinese Audio</p>
      <div class="container">
        <button class="btn btn-primary btn-sm col-sm-3 mt-3 mb-4" id="changeLangAUD">
          Change Language
        </button>
      </div>
      <form method="POST" class="form-group row mt-5">
        {% csrf_token %}
        <label for="audioInput1" class="col-sm-2 col-form-label text-center" id="audioLabel1">🎵 <kbd>第一首歌</kbd>
          🎶</label>
        <div class="col-sm-10">
          <input type="text" class="form-control form-control-sm" id="audioInput1" name="audioInput1" value=""
            placeholder="Answer" tabindex="1" required>
        </div>
        <label for="audioInput2" class="col-sm-2 col-form-label text-center" id="audioLabel2">🎵 <kbd>第二首歌</kbd>
          🎶</label>
        <div class="col-sm-10">
          <input type="text" class="form-control form-control-sm" id="audioInput2" name="audioInput2" value=""
            placeholder="Answer" tabindex="2" required>
        </div>
        <label for="audioInput3" class="col-sm-2 col-form-label text-center" id="audioLabel3">🎵 <kbd>第三首歌</kbd>
          🎶</label>
        <div class="col-sm-10">
          <input type="text" class="form-control form-control-sm" id="audioInput3" name="audioInput3" value=""
            placeholder="Answer" tabindex="3" required>
        </div>
        <label for="audioInput4" class="col-sm-2 col-form-label text-center" id="audioLabel4">🎵 <kbd>第四首歌</kbd>
          🎶</label>
        <div class="col-sm-10">
          <input type="text" class="form-control form-control-sm" id="audioInput4" name="audioInput4" value=""
            placeholder="Answer" tabindex="4" required>
        </div>
        <label for="audioInput5" class="col-sm-2 col-form-label text-center" id="audioLabel5">🎵 <kbd>第五首歌</kbd>
          🎶</label>
        <div class="col-sm-10">
          <input type="text" class="form-control form-control-sm" id="audioInput5" name="audioInput5" value=""
            placeholder="Answer" tabindex="5" required>
        </div>
        <div class="container">
          <input class="btn btn-primary col-sm-2 mt-5" type="submit" value="Submit" />
        </div>
      </form>
      {% elif mission.id == 3 %}
      <br>
      <div class="embed-responsive embed-responsive-16by9">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/zSZ2-9T5hEM" frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
      <br>
      <br>
      <button class="btn btn-primary btn-sm col-sm-3 mb-4" id="changeLang">
        Change Language
      </button>
      <form method="POST" class="form-group row" id="carcam-form">
        {% csrf_token %}
      </form>
      {% elif mission.id == 4 %}
      <br>
      <br>
      <div class="container">
        <div id="crossword-img" class="row" style="text-align: center; display: block;">
          <img src="{% static 'game/crossword/Crossword.jpeg' %}" style="max-width: 100%; height: auto;"
            alt="Crossword">
          <div class="container">
            <form class="mt-5" method="POST">
              {% csrf_token %}
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ1" name="crosswordQ1"
                placeholder="id**li*" tabindex="1" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ2" name="crosswordQ2"
                placeholder="s**i****r*n**" tabindex="2" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ3" name="crosswordQ3"
                placeholder="q*ix*ti*" tabindex="3" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ4" name="crosswordQ4"
                placeholder="*lo*k*n*piel" tabindex="4" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ5" name="crosswordQ5"
                placeholder="**os" tabindex="5" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ6" name="crosswordQ6"
                placeholder="m*s***s*p*i" tabindex="6" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ7" name="crosswordQ7"
                placeholder="s**a*f**o" tabindex="7" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ8" name="crosswordQ8"
                placeholder="***t*g" tabindex="8" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-3"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ9" name="crosswordQ9"
                placeholder="****ph****l*a" tabindex="9" required>
              <input class="form-control form-control-sm text-center col-sm-4 mb-5"
                style="display: block; margin-right: auto; margin-left: auto;" id="crosswordQ10" name="crosswordQ10"
                placeholder="l*r*nx" tabindex="10" required>
              <button type="submit" class="btn btn-primary">Submit</button>
            </form>
          </div>
        </div>
      </div>
      {% elif mission.id == 5 %}
      <div class="container mt-4">
        <div class="" id="uploadAlert" role="alert">
        </div>
        <div class="row">
          <div class="col">
            <p id="ScreenshotTitle1" style="display: none;"><b>Person 1 第一个人</b></p>
            <img id="UploadedScreenshot1" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle2" style="display: none;"><b>Person 2 第二个人</b></p>
            <img id="UploadedScreenshot2" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle3" style="display: none;"><b>Person 3 第三个人</b></p>
            <img id="UploadedScreenshot3" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle4" style="display: none;"><b>Person 4 第四个人</b></p>
            <img id="UploadedScreenshot4" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle5" style="display: none;"><b>Person 5 第五个人</b></p>
            <img id="UploadedScreenshot5" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle6" style="display: none;"><b>Person 6 第六个人</b></p>
            <img id="UploadedScreenshot6" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle7" style="display: none;"><b>Person 7 第七个人</b></p>
            <img id="UploadedScreenshot7" src="#" alt="" />
          </div>
          <div class="col">
            <p id="ScreenshotTitle8" style="display: none;"><b>Person 8 第八个人</b></p>
            <img id="UploadedScreenshot8" src="#" alt="" />
          </div>
        </div>
      </div>
      <form method="POST" enctype="multipart/form-data" class="upload-form" id="QuanMinForm">
        {% csrf_token %}
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot1" name="QuanMin1" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel1" for="customFile">Person
            1</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot2" name="QuanMin2" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel2" for="customFile">Person
            2</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot3" name="QuanMin3" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel3" for="customFile">Person
            3</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot4" name="QuanMin4" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel4" for="customFile">Person
            4</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot5" name="QuanMin5" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel5" for="customFile">Person
            5</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot6" name="QuanMin6" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel6" for="customFile">Person
            6</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot7" name="QuanMin7" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel7" for="customFile">Person
            7</label>
        </div>
        <div class="custom-file col-sm-3 mb-2 mr-1">
          <input type="file" class="custom-file-input" id="QuanMinScreenshot8" name="QuanMin8" accept="image/*">
          <label class="custom-file-label text-left quanmin-screenshot-label" id="QuanMinLabel8" for="customFile">Person
            8</label>
        </div>
        <div class="container">
          <input class="btn btn-primary col-sm-2 mt-3" type="submit" value="Submit" />
        </div>
      </form>
      {% elif mission.id == 6 %}
      <br>
      <br>
      <h5>The poll will open when the debate is ended.</h5>
      <script src='https://poll.app.do/iframe/testing-poll-2867017.js'></script>
      {% endif %}
    </div>
  </div>
</div>
<script>
  // Disable Form Resubmission withou RPG(Redirect/Post/Get)
  if ( window.history.replaceState ) {
    window.history.replaceState( null, null, window.location.href );
  }

  function descChangeLang() {
    var instructionTitle = document.querySelector("#instructionTitle");
    var missionDescChi = document.querySelector("#missionDescChi");
    var missionDescEng = document.querySelector("#missionDescEng");
    var titleChi = document.querySelector("#titleChi");
    var titleEng = document.querySelector("#titleEng");
    var languageSwitcher = document.querySelector("#languageSwitcher");

    if (instructionTitle.innerText.includes("指示")) {
      instructionTitle.innerHTML = "<b><u>Instructions</u></b>";
      missionDescChi.setAttribute("style", "display: none;");
      missionDescEng.setAttribute("style", "");
      titleChi.setAttribute("style", "display: none;");
      titleEng.setAttribute("style", "font-weight: 700;");
      languageSwitcher.innerHTML = 'English';
    } else {
      instructionTitle.innerHTML = "<b><u>指示</u></b>";
      missionDescChi.setAttribute("style", "");
      missionDescEng.setAttribute("style", "display: none;");
      titleChi.setAttribute("style", "font-weight: 700;");
      titleEng.setAttribute("style", "display: none;");
      languageSwitcher.innerHTML = '中文';
    }
  }

  {% if mission.id == 1 %}
  function changeSpotIMG() {
    var button = document.querySelector("#SpotIMGButton");
    var img1 = document.querySelector("#SpotIMG1");
    var img2 = document.querySelector("#SpotIMG2");

  {% autoescape off %}
    if (button.innerHTML.includes('Vertical ➡️ Horizontal')) {
      img1.src = "{% static 'game/spot/HorizontalSpot1.jpg' %}";
      img2.src = "{% static 'game/spot/HorizontalSpot2.jpg' %}";
      button.innerHTML = 'Horizontal ➡️ Vertical'
    } else {
      img1.src = "{% static 'game/spot/VerticalSpot1.jpg' %}";
      img2.src = "{% static 'game/spot/VerticalSpot2.jpg' %}";
      button.innerHTML = 'Vertical ➡️ Horizontal';
    }
  }
  {% endautoescape %}
  {% endif %}

  {% if mission.id == 2 %}

  {% if mission.id == 2 and messages|length == 0 %}
  // Disable the messages first
  document.getElementById("main-container").setAttribute("style", "display: none;")
  
  // Load Youtube API asynchronously
  var tag = document.createElement('script');

  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  // This function creates an <iframe> (and YouTube player)
  // after the API code downloads.
  var player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('mission2-video', {
      videoId: 'GS46Us9E4Oc',
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }

  // The API will call this function when the video player is ready.
  function onPlayerReady(event) {
    event.target.playVideo();
  }

  // The API calls this function when the player's state changes.
  // the player should enable button when the video is finished.
  function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.ENDED) {
      document.querySelector("#start-button").classList.remove("disabled");
      document.querySelector("#start-button").disabled = false;
    }
  }

  // When start button is clicked
  function startAudio() {
    document.querySelector("#start-button").setAttribute("style", "display: none;");
    document.querySelector("#yt-player").setAttribute("style", "display: none;");
    document.getElementById("main-container").setAttribute("style", "");
  }
  {% endif %}

  window.addEventListener('DOMContentLoaded', function () {
    // Change Language on button click
    document.getElementById("changeLangAUD").addEventListener('click', () => {
      const chiNums = ['一', '二', '三', '四', '五'];
      {% autoescape off %}
      var audioChi = "{% static 'game/audio/CorruptedAudioChinese.mp3' %}";
      var audioEng = "{% static 'game/audio/CorruptedAudioEnglish.mp3' %}";
      {% endautoescape %}

      var audio = document.querySelector("#CorruptedAudio");
      var audiosrc = document.querySelector("#CorruptedAudioSource");

      if (audio.innerHTML.indexOf("CorruptedAudioChinese") !== -1) {
        audiosrc.src = audioEng;
        document.querySelector("#CorruptedAudioTitle").innerHTML = 'English Audio'
      }
      else {
        audiosrc.src = audioChi;
        document.querySelector("#CorruptedAudioTitle").innerHTML = 'Chinese Audio'
      }

      audio.load();

      for (var i = 0; i < 5; i++) {
        const label = document.querySelector("#audioLabel" + (i + 1).toString());

        if (label.innerText.indexOf("第") !== -1)
          label.innerHTML = `🎵 <kbd>Song ${(i + 1)}</kbd> 🎶`;
        else
          label.innerHTML = `🎵 <kbd>第${chiNums[i]}首歌</kbd> 🎶`;
      }
    })

    {% autoescape off %}
    {% if SongAnswers == None %}
    {% else %}
    var SongAnswers = {{ SongAnswers }};
    var SongResults = {{ SongResults }};
    {% endif %}
    {% endautoescape %}

  for (var i = 0; i < SongResults.length; i++) {
    if (SongResults[i] == "False") {
      document.getElementById('audioInput' + (i + 1).toString()).classList.add("is-invalid");
    } else if (SongResults[i] == "True") {
      document.getElementById('audioInput' + (i + 1).toString()).classList.add("is-valid");
    }
    document.getElementById('audioInput' + (i + 1).toString()).value = SongAnswers[i];
  }
  });
  {% endif %}

  {% if mission.id == 3 %}
  // Setting variables
  {% autoescape off %}
  var CarcamQuesChi = {{ CarcamQuesChi }};
  var CarcamQuesEng = {{ CarcamQuesEng }};
  var Timecode = {{ Timecode }};
  var OneWordAns = [1, 3, 4, 5, 7, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20];
  var TimecodeAns = [12];

  {% if CarcamAnswers == None %}
  {% else %}
  var CarcamResults = {{ CarcamResults }};
  var CarcamAnswers = {{ CarcamAnswers }};
  {% endif %}
  {% endautoescape %}

  document.addEventListener('DOMContentLoaded', () => {
    // Create 20 questions
    for (var i = 0; i < CarcamQuesChi.length; i++) {
      const question = document.createElement('label');
      const div = document.createElement('div');
      const input = document.createElement('input');

      // Setting attributes of input
      question.setAttribute("id", "carcam-question");
      question.setAttribute("for", "inputQ" + (i + 1).toString());
      question.setAttribute("style", "font-size: x-large;");
      question.classList.add("col-sm-10", "col-form-label", "text-left");
      if (Timecode[i] == "")
        question.innerHTML = `${(i + 1)}) ${CarcamQuesChi[i]}`;
      else
        question.innerHTML = `${(i + 1)}) <kbd>${Timecode[i]}</kbd> ${CarcamQuesChi[i]}`;

      // Setting attributes of div
      div.classList.add("col-sm-2");

      // Setting attributes of input
      input.setAttribute("id", "carcam-answer");
      input.setAttribute("name", "inputQ" + (i + 1).toString());
      input.setAttribute("type", "text");
      if (OneWordAns.includes((i + 1)))
        input.setAttribute("placeholder", "One Word");
      else if (TimecodeAns.includes((i + 1)))
        input.setAttribute("placeholder", "Timecode");
      else
        input.setAttribute("placeholder", "Answer");
      input.setAttribute("tabindex", (i + 1).toString());
      input.setAttribute("required", "");
      // input.setAttribute("value", `${Answers[i]}`);
      input.classList.add("form-control");

      // Adding inputs into the div
      div.append(input)

      document.querySelector("#carcam-form").append(question);
      document.querySelector("#carcam-form").append(div);
    }

    // Create Submit Button
    const container = document.createElement('div');
    const submit = document.createElement('input');

    // Setting the attributes 
    container.classList.add("container");
    submit.setAttribute("type", "submit");
    submit.setAttribute("value", "Submit");
    submit.setAttribute("tabindex", (CarcamQuesChi.length + 1).toString());
    submit.classList.add("btn", "btn-primary", "col-sm-2", "mt-5");

    container.append(submit);
    document.querySelector("#carcam-form").append(container);

    var CarcamInputs = document.querySelectorAll('#carcam-answer');

    // Checking for correct/incorrect answers
    for (var i = 0; i < CarcamResults.length; i++) {
      if (CarcamResults[i] == "False") {
        CarcamInputs[i].classList.add("is-invalid");
      } else if (CarcamResults[i] == "True") {
        CarcamInputs[i].classList.add("is-valid");
      }
      CarcamInputs[i].value = CarcamAnswers[i];
    }
  })

  // Change Language on button click
  document.getElementById("changeLang").addEventListener('click', () => {
    for (var i = 0; i < CarcamQuesChi.length; i++) {
      const questions = document.querySelectorAll("#carcam-question");
      const inputs = document.querySelectorAll("#carcam-answer");

      if (questions[i].innerHTML == `${(i + 1)}) ${CarcamQuesChi[i]}`) {
        questions[i].innerHTML = `${(i + 1)}) ${CarcamQuesEng[i]}`;
        questions[i].setAttribute("style", "font-size: normal;");
        inputs[i].setAttribute("class", "form-control form-control-sm");
      } else if (questions[i].innerHTML == `${(i + 1)}) <kbd>${Timecode[i]}</kbd> ${CarcamQuesChi[i]}`) {
        questions[i].innerHTML = `${(i + 1)}) ${CarcamQuesEng[i]}`;
        questions[i].setAttribute("style", "font-size: normal;");
        inputs[i].setAttribute("class", "form-control form-control-sm");
      } else if (questions[i].innerHTML == `${(i + 1)}) <kbd>${Timecode[i]}</kbd> ${CarcamQuesEng[i]}`) {
        questions[i].innerHTML = `${(i + 1)}) <kbd>${Timecode[i]}</kbd> ${CarcamQuesChi[i]}`;
        questions[i].setAttribute("style", "font-size: x-large;");
        inputs[i].setAttribute("class", "form-control");
      } else {
        questions[i].innerHTML = `${(i + 1)}) ${CarcamQuesChi[i]}`;
        questions[i].setAttribute("style", "font-size: x-large;");
        inputs[i].setAttribute("class", "form-control");
      }
    }
  })
  {% endif %}

  {% if mission.id == 4 %}
  window.addEventListener('DOMContentLoaded', function () {
    {% autoescape off %}
    {% if CrosswordAnswers == None %}
    {% else %}
    var CrosswordResults = {{ CrosswordResults }};
    var CrosswordAnswers = {{ CrosswordAnswers }};
    {% endif %}
    {% endautoescape %}

  for (var i = 0; i < CrosswordResults.length; i++) {
    if (CrosswordResults[i] == "False") {
      document.getElementById('crosswordQ' + (i + 1).toString()).classList.add("is-invalid");
    } else if (CrosswordResults[i] == "True") {
      document.getElementById('crosswordQ' + (i + 1).toString()).classList.add("is-valid");
    }
    document.getElementById('crosswordQ' + (i + 1).toString()).value = CrosswordAnswers[i];
  }
  })
  {% endif %}

  {% if mission.id == 5 %}
  window.addEventListener('DOMContentLoaded', function () {
    var screenshotInput1 = document.querySelector("#QuanMinScreenshot1");
    var screenshotInput2 = document.querySelector("#QuanMinScreenshot2");
    var screenshotInput3 = document.querySelector("#QuanMinScreenshot3");
    var screenshotInput4 = document.querySelector("#QuanMinScreenshot4");
    var screenshotInput5 = document.querySelector("#QuanMinScreenshot5");
    var screenshotInput6 = document.querySelector("#QuanMinScreenshot6");
    var screenshotInput7 = document.querySelector("#QuanMinScreenshot7");
    var screenshotInput8 = document.querySelector("#QuanMinScreenshot8");


    screenshotInput1.addEventListener('change', function (e) {
      if (!(screenshotInput1.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput1.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput1.value = "";
          document.querySelector("#QuanMinLabel1").innerText = 'Person 1';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput1.files[0].name;
          document.querySelector("#QuanMinLabel1").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot1");
          var preview = document.getElementById("UploadedScreenshot1");
          var previewTitle = document.getElementById("ScreenshotTitle1");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all <b>8 valid screenshots</b> before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput2.addEventListener('change', function () {
      if (!(screenshotInput2.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput2.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput2.value = "";
          document.querySelector("#QuanMinLabel2").innerText = 'Person 2';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput2.files[0].name;
          document.querySelector("#QuanMinLabel2").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot2");
          var preview = document.getElementById("UploadedScreenshot2");
          var previewTitle = document.getElementById("ScreenshotTitle2");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all <b>8 valid screenshots</b> before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput3.addEventListener('change', function () {
      if (!(screenshotInput3.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput3.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput3.value = "";
          document.querySelector("#QuanMinLabel3").innerText = 'Person 3';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput3.files[0].name;
          document.querySelector("#QuanMinLabel3").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot3");
          var preview = document.getElementById("UploadedScreenshot3");
          var previewTitle = document.getElementById("ScreenshotTitle3");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all <b>8 valid screenshots</b> before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput4.addEventListener('change', function () {
      if (!(screenshotInput4.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput4.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput4.value = "";
          document.querySelector("#QuanMinLabel4").innerText = 'Person 4';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput4.files[0].name;
          document.querySelector("#QuanMinLabel4").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot4");
          var preview = document.getElementById("UploadedScreenshot4");
          var previewTitle = document.getElementById("ScreenshotTitle4");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all 8 valid screenshots before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput5.addEventListener('change', function () {
      if (!(screenshotInput5.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput5.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput5.value = "";
          document.querySelector("#QuanMinLabel5").innerText = 'Person 5';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput5.files[0].name;
          document.querySelector("#QuanMinLabel5").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot5");
          var preview = document.getElementById("UploadedScreenshot5");
          var previewTitle = document.getElementById("ScreenshotTitle5");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all 8 valid screenshots before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput6.addEventListener('change', function () {
      if (!(screenshotInput6.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput6.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput6.value = "";
          document.querySelector("#QuanMinLabel6").innerText = 'Person 6';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput6.files[0].name;
          document.querySelector("#QuanMinLabel6").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot6");
          var preview = document.getElementById("UploadedScreenshot6");
          var previewTitle = document.getElementById("ScreenshotTitle6");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all 8 valid screenshots before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput7.addEventListener('change', function () {
      if (!(screenshotInput7.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput7.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput7.value = "";
          document.querySelector("#QuanMinLabel7").innerText = 'Person 7';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput7.files[0].name;
          document.querySelector("#QuanMinLabel7").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot7");
          var preview = document.getElementById("UploadedScreenshot7");
          var previewTitle = document.getElementById("ScreenshotTitle7");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all 8 valid screenshots before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })

    screenshotInput8.addEventListener('change', function () {
      if (!(screenshotInput8.files[0] == undefined)) {
        const supportedExtensions = ['jpeg', 'jpg', 'png', 'gif'];

        const path = screenshotInput8.files[0].name.split('.');
        const extension = `${path[path.length - 1]}`.toLowerCase();

        if (!(supportedExtensions.includes(extension))) {
          screenshotInput8.value = "";
          document.querySelector("#QuanMinLabel8").innerText = 'Person 8';
          alert("Invalid File Types, upload images only.");
        } else {
          var fileName = screenshotInput8.files[0].name;
          document.querySelector("#QuanMinLabel8").innerHTML = fileName;

          var fileTag = document.getElementById("QuanMinScreenshot8");
          var preview = document.getElementById("UploadedScreenshot8");
          var previewTitle = document.getElementById("ScreenshotTitle8");
          var uploadAlert = document.getElementById("uploadAlert");

          changeImage(this);

          function changeImage(input) {
            var reader;

            if (input.files && input.files[0]) {
              reader = new FileReader();

              reader.onload = function (e) {
                preview.setAttribute('src', e.target.result);
                uploadAlert.classList.add('alert', 'alert-warning', 'mb-5');
                uploadAlert.innerHTML = "Uploaded Screenshots will be displayed below.<br><i>please make sure you uploaded all 8 valid screenshots before submitting.</i>";
                previewTitle.setAttribute('style', '');
                preview.setAttribute('style', 'width: 216px; height: 456px;');
                preview.setAttribute('class', 'mb-5');
              }

              reader.readAsDataURL(input.files[0]);
            }
          }
        }
      }
    })
  })
  {% endif %}
</script>
{% endblock %}